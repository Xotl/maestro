var nconf = require('nconf');

module.exports = {
  //Returns a Json object coming from config.json
  //example: var configJson = require('config-json-helper');
  //         console.log(configJson.get('site:node'));

  get: function(key){
    var r = '';
    try {
      nconf.use('file', { file: sails.config.env.config.location });
      nconf.load();
      r = nconf.get(key);
    } catch (error) {
      console.log(error);
    }
    return r;
  },
  //Returns node name String, empty String on error
  //example: ci.x7.dev.forj.io
  getNode: function(app){
    var r = '';
    try {
      nconf.use('file', { file: sails.config.env.config.location });
      nconf.load();
      var nodes = nconf.get('site:node');
      for (i=0; i<nodes.length; i++){
        if (nodes[i]=="default"){
          continue;
        }
        // console.log(nodes[i].node_name);
        for (var j=0; j<nodes[i].tools.length; j++){
          // console.log("  " + nodes[i].tools[j].name);
          if (nodes[i].tools[j].name == app){
            r = nodes[i].node_name;
            break;
          }
        }
      }
    } catch (error) {
      console.error(error);
    }
    return r;
  },
}
